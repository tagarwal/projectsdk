<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>Getting Started</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <meta name="keywords" content="">
    <meta name="generator" content="J4C">

    <!-- Le styles -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
    <link href="css/bootstrap_yeti.css" rel="stylesheet">
    <link href="css/base.css" rel="stylesheet">
    <link href="css/prettify.css" rel="stylesheet">
    <link href="css/bootstrap-toc.min.css" rel="stylesheet">

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="js/html5shiv.min.js"></script>
    <![endif]-->

    <!-- Fav and touch icons -->
    <!-- <link rel="shortcut icon" href="favicon.ico"> -->
  </head>
  <body data-spy="scroll" data-target="#toc" data-offset="100" onload="prettyPrint()">
    <div id="wrap">
    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="index.html">J4C</a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="samples.html">Samples</a></li>
            <li><a href="starter/">Project Starter</a></li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">Documentation<b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li><a href="getting-started.html">Getting Started</a></li>
                <li><a href="developer-guide.html">Developer Guide</a></li>
                <li><a href="javadocs.html">Javadocs</a></li>
              </ul>
            </li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle disabled" data-toggle="dropdown">Older Versions<b class="caret"></b></a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="container" style="">

        <div class="docs-header" id="content" style="padding-left:0; padding-right:0">
          <div class="container">
            <h1>Getting Started</h1>
            
          </div>
        </div>

<div class="col-md-3" style="padding-left:0"><nav id="toc" data-spy="affix" data-offset-top="240" data-toggle="toc" class="bs-docs-sidebar"><ul class="nav"><li><a href="#_installing_and_checking_prerequisites">Installing and Checking Prerequisites</a></li><li><a href="#_setting_maven_opts_and_gradle_opts">Setting MAVEN_OPTS and GRADLE_OPTS</a></li><li><a href="#_generating_a_project_using_the_j4c_starter">Generating a Project using the J4C Starter</a></li><li><a href="#_building_the_project">Building the Project</a></li><li><a href="#_deploying_and_accessing_the_service">Deploying and Accessing the Service</a><ul class="nav"><li><a href="#_running_with_kubernetes">Running with Kubernetes</a></li><li><a href="#_running_locally_without_kubernetes">Running Locally (without Kubernetes)</a></li></ul></li></ul></nav></div><div class="col-md-9" role="main"><div class="docs-content"><div class="sect1">
<h2 id="_installing_and_checking_prerequisites">Installing and Checking Prerequisites</h2>
<div class="sectionbody">
<div class="paragraph">
<p>J4C requires no installation (other than prerequisites).
You develop with J4C using common developer tools you are already familiar with.</p>
</div>
<div class="paragraph">
<p>J4C requires Java 9, Maven 3, Git, and Docker (if you want to
generate and deploy Docker containers). Many of the examples also use
curl to ping the service. Make sure you have these installed on your system:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 1. Prerequisites</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Software</th>
<th class="tableblock halign-left valign-top">Usage</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Java 9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Java 9 is required for the new J4C APIs (they use Java 9 language features)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maven 3 or Gradle 4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Your choice!</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Docker 17.03 or newer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Needed if you want to build and run docker containers</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kubectl</code> 1.7 and access to a Kubernetes 1.7  cluster</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">To deploy and access the service in the cluster</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>curl</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For pinging demo app</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Setting JAVA_HOME</div>
<div class="content">
<pre># On Mac
export JAVA_HOME=`/usr/libexec/java_home -v 9`

# On Linux
export JAVA_HOME=/usr/lib/jvm/jdk-9    # Or wherever your Java 9 installation is at</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_setting_maven_opts_and_gradle_opts">Setting MAVEN_OPTS and GRADLE_OPTS</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The generated project supports building of docker images using Maven (or Gradle).
In order for this to work with Java 9 you must set some options. Note that
these options only work with Java 9. If you do not plan on generating a docker
image then you can skip this section.</p>
</div>
<div class="listingblock">
<div class="title">Setting <code>MAVEN_OPTS</code></div>
<div class="content">
<pre>export MAVEN_OPTS="--add-modules java.xml.bind \
    --add-opens java.base/java.lang=ALL-UNNAMED \
    --add-opens java.xml.bind/javax.xml.bind=ALL-UNNAMED \
    --add-opens java.activation/javax.activation=ALL-UNNAMED \
    -Xmx1024M"</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Setting <code>GRADLE_OPTS</code></div>
<div class="content">
<pre>export GRADLE_OPTS="--add-opens java.base/java.lang=ALL-UNNAMED \
    --add-opens java.base/java.util=ALL-UNNAMED"</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_generating_a_project_using_the_j4c_starter">Generating a Project using the J4C Starter</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Shift-Click on Project Starter to open the J4C Starter in a new window</p>
</li>
<li>
<p>Select <code>Maven</code> or <code>Gradle</code> Project</p>
</li>
<li>
<p>Click on J4C HTTP Stack with Jersey</p>
</li>
<li>
<p>Click <code>Generate Project</code></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>This will generate and download a zip file containing your project.
We will assume the file is named <code>my-app.zip</code>.</p>
</div>
<div class="listingblock">
<div class="title">Unzip the project</div>
<div class="content">
<pre>$ mkdir my-app; cd my-app
$ unzip ~/Downloads/my-app.zip
$ ls -R
. . .</pre>
</div>
</div>
<div class="paragraph">
<p>Some systems might automatically unzip the file, leaving the directory <code>my-app/</code> in the downloads directory. You can then simply move that directory to a working area and <code>cd</code> to there.</p>
</div>
<div class="listingblock">
<div class="title">Move an auto-unzipped project</div>
<div class="content">
<pre>$ mv ~/Downloads/my-app .
$ cd my-app
$ ls -R
. . .</pre>
</div>
</div>
<div class="paragraph">
<p>You will see that the sample project has a <code>pom.xml</code> (or <code>build.gradle</code>) file, <code>Dockerfile</code>, <code>app.yaml</code>, and example source. The example application is a very basic J4C WebServer example that demonstrates support for Jersey (JAX-RS) applications.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_building_the_project">Building the Project</h2>
<div class="sectionbody">
<div class="paragraph">
<p>After you have made any changes you want to the generated source build using</p>
</div>
<div class="listingblock">
<div class="title">Build the project</div>
<div class="content">
<pre>$ mvn install               # Or gradle build</pre>
</div>
</div>
<div class="paragraph">
<p>or do the equivalent from your IDE.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_deploying_and_accessing_the_service">Deploying and Accessing the Service</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_running_with_kubernetes">Running with Kubernetes</h3>
<div class="paragraph">
<p>After you have built the project, create and deploy  your service image using Docker and kubectl:</p>
</div>
<div class="listingblock">
<div class="title">Build the Docker image</div>
<div class="content">
<pre>$ docker build target/ -t my-app:latest -t my-app:1.0-SNAPSHOT
Sending build context to Docker daemon  9.334MB
Step 1 : FROM openjdk:9-jdk
 ---&gt; 24b282e06a5a
Step 2 : RUN mkdir /app
 ---&gt; Using cache
 ---&gt; 7bb58e4aecd8
Step 3 : COPY my-app.jar /app
 ---&gt; 962937a15854
Removing intermediate container 7a5bf62307c9
Step 4 : COPY libs /app/libs
 ---&gt; 90059c8bac83
Removing intermediate container 5e2a89a48838
Step 5 : ENTRYPOINT java -jar /app/my-app.jar $@
 ---&gt; Running in 314d4140e957
 ---&gt; 8d49e3a638ba
Removing intermediate container 314d4140e957
Successfully built 8d49e3a638ba
$</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Deploy the Docker image to Kubernetes</div>
<div class="content">
<pre>$ kubectl create -f k8s/app.yaml
service "my-app" created
deployment "my-app" created
$</pre>
</div>
</div>
<div class="paragraph">
<p>The generated <code>app.yaml</code> file does not use a load balancer (although you can change it to do so if you want). So, now that the service is deployed, you need to find out what port Kubernetes has exposed for the service.</p>
</div>
<div class="listingblock">
<div class="title">Find the exposed URL for your service</div>
<div class="content">
<pre>$ kubectl get service my-app
NAME      CLUSTER-IP   EXTERNAL-IP   PORT(S)          AGE
my-app    10.0.0.46    &lt;nodes&gt;       8080:32471/TCP   20s
$</pre>
</div>
</div>
<div class="paragraph">
<p>Note which external port (32471) Kubernetes has associated with the service&#8217;s port (8080) in this example. Your external port will probably be different from this example and can change if you deploy your service again.</p>
</div>
<div class="paragraph">
<p>Combine the node name or IP address of the system running your Kubernetes node with the exposed port to construct the full URL. For example, <code><a href="http://w.x.y.z:32471" class="bare">http://w.x.y.z:32471</a></code></p>
</div>
<div class="paragraph">
<p>If you are using minikube you can also find the host and port this way:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ minikube service my-app --url
http://192.168.99.100:32471
$</pre>
</div>
</div>
<div class="paragraph">
<p>Use a browser or <code>curl</code> to access the service at the exposed port you just found. Be sure to include the path <code>/jersey/hello</code> and not just the host and port.</p>
</div>
<div class="listingblock">
<div class="title">Access the deployed service</div>
<div class="content">
<pre>$ curl http://192.168.99.100:32471/jersey/hello
Hello World!
$</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_running_locally_without_kubernetes">Running Locally (without Kubernetes)</h3>
<div class="paragraph">
<p>If you do not have a Kubernetes cluster to deploy to, or if you just want to try out your project before deploying it to Kubernetes, you can run the service locally on your system as a quick test, without involving Kubernetes.</p>
</div>
<div class="paragraph">
<p>After you have build your project, start it locally:</p>
</div>
<div class="listingblock">
<div class="title">Start the demo application</div>
<div class="content">
<pre>$ mvn exec:java             # Or gradle run

# Ctrl-C to stop the application</pre>
</div>
</div>
<div class="paragraph">
<p>Use <code>curl</code> or your web browser to access the service:</p>
</div>
<div class="listingblock">
<div class="title">Access the local service</div>
<div class="content">
<pre>$ curl http://localhost:8080/jersey/hello
Hello World!</pre>
</div>
</div>
</div>
</div>
</div></div></div>

            </div>
    <div id="footer">
      <div class="container">
        <p class="muted credit">Copyright &copy; 2017 | All Rights Reserved.</a></p>
      </div>
    </div>
    </div>

    <!-- Placed at the end of the document so the pages load faster -->
    <script src="js/jquery-1.8.3.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/prettify.js"></script>

    <script type="text/javascript">
        $(function() {
            $('#toc a').click(function(){
                $('html, body').animate({
                      scrollTop: $($(this).attr('href')).offset().top - 65
                  }, 10);
                });
            });
    </script>
  </body>
</html>